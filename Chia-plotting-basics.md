# 农田开垦入门
## 基本介绍
想成为Chia网络一名合格的农民需要了解两件事情，即开垦农田以及耕种农田。本章会着重讲解农田的开垦过程，开垦农田所用到的计算机配置和储存空间需求与耕种农田的设备是不同的，关于耕种农田所需要的设备配置要求，你可以参考文档[耕种设备](Reference-Farming-Hardware)


**建议刚开始的时候使用你现有的设备进行农田的开垦测试**， 需要注意的是，使用设备自带或者消费级SSD固态盘作为开垦农田过程中的缓存盘时，要关注一下不同的SSD固态盘，它的寿命及可开垦的农田数量是不一样的，详情可以参考文档[SSD寿命概况](SSD-Endurance)。

暂时不推荐开垦大于K32的[农田格式](k-sizes)，这么做的，要么是为了测试娱乐，要么就是为了尽量[填满硬盘的空间](https://plot-plan.chia.foxypool.io/)。一个K32的农田大概占用 101.3 GiB的空间，但在开垦它的过程中，会产生 239 GiB 缓存文件，也就说，开垦一个K32农田任务只需要 239 GiB的空间。这里要注意一下，GiB是文件总字节数除了3次1024而得，GB是文件总字节数除了3次1000而得，即缓存空间 239 GiB = 256.6 GB ，K32农田大小 101.3 GiB = 108.8 GB。熟悉开垦农田的人可以在4小时内开垦完一块K32农田，但更多人开垦一块K32农田需要花5小时甚至更久。

开垦一块农田的过程，需要占用内存，CPU资源以及反复读写硬盘，在开垦的四个阶段中，不同阶段对硬件资源使用的情况也有所不同。每一个开垦农田的人都想知道一个最佳的硬件设备组合，然而每台设备的参数都各尽不同，所以需要自己去尝试并不断调整。你也可以进入社区讨论组， 与社区成员互相讨论来配置适合自己使用的最佳硬件配置。

## 入门开垦
第一阶段将会生成所有的空间证明，它们是由7张加密哈希表组成并保存在缓存目录中。第二阶段就开始对这些哈希表从后向前进行反向传播运算，第三阶段对这些哈希值进行排序及压缩运算，并开始构建形成农田文件。最后在第四阶段完成农田并将其传输到指定的最终目录。

开垦过程中的最大瓶颈就是缓存目录磁盘的持续写入速度。如果你想更快更稳定地开垦农田，[推荐的开垦方案](FAQ#推荐的开垦方案)是使用企业级SSD而不是消费级SSD设备。通常来讲，读写速度的排序：NVME/SSD > SAS >SATA。TBW，或者称之为太字节写入量，用来描述NVME/SSD固态硬盘的寿命（关于硬件缩写不懂的请自行百度查询详细解释或者查看PCworld的[文章](https://www.pcworld.com/article/2899351/everything-you-need-to-know-about-nvme.html)）。禁用位域（高级选项中可选）时开垦一个K32农田会消耗1.8 TiB的写入量，启用位域则消耗 1.6 TiB，后面会详细介绍关于位域的内容。

然而以最快的速度只开垦一块农田并合适的方案。大家使用的电脑都是多核处理器，使用并行任务进行开垦，速度会快很多。所以，你需要关注一下你的开垦设备并行开垦农田的话，每天能够完成多少TB的农田，以此来规划你的开垦任务。有些人会使用企业级SSD，或者SAS硬盘，使用RAID 0对缓存所用的 SSD 或者 HDD 进行组合连接，可以提升传输速度以及缓存容量，假设组成了一个2TB的缓存分区，那么此RAID硬盘就可以同时容纳5个K32农田的缓存，也就是说可以同时开垦5块K32农田。

综上所述，针对我个人计算机的配置，2017年的MAC主机，12TB桌面式西数硬盘USB3.0连接，同时作为缓存目录及最终目录，这样我开垦一块K32农田需要10个小时。

## 关于位域（bit-field）
按照目前已有的经验总结，是否使用位域会对开垦农田的速度产生一定影响。首先需要解释一下开垦时开启位域与禁止位域有什么区别。最开始的时候，开垦程序没有使用“位域”这种数据结构来进行排序，理论上来讲，启用“位域”排序后会比禁用“位域”排序速度更快，同时还会减少12%的缓存写入量，不过需要占用更多的内存。在未来，我们将研究如何使用多核处理器来加速“位域”排序并有望提升10%的速度。但就目前所知，如果你使用 SSD 或者高速 SAS 硬盘作为缓存盘时，禁用位域开垦的要快一些，但会增加12%的缓存写入量。如果你把常规机械硬盘设置为缓存目录的话，启用位域排序将会提升20%的开垦速度，但使用比较老的cpu开垦就不会有这么明显的速度提升。

这里阐述一些设定。不要将条带大小设置超过64KB，超过该值对速度并没有什么提升作用，我们将会把这个选项从列表中删除（更新：从2021年3月11日去，条带大小选项已移除）。桶数设置建议为128桶（开垦是，所产生缓存文件的数量），桶数越少需要占用的内存就会越多，比如64桶相比128桶就需要2倍的内存。

关于线程，一般每个开垦任务需要2~4个线程。4个以上线程对开垦速度有所小幅度提升，但比较有限。可以确定的是2个线程相比1个线程，速度提升很多。线程使用的越多，内存也就会占用越多，目前多线程开垦仅适用于第一阶段。

从1.0.4版本开始，无论启用还是禁用位域，内存占用基本相同。下表为在开垦K32农田，桶数设置为128桶，线程选用2~4个时所占用内存的大小。

| 内存需求 MiB: |	 最小值 | 中间值 	| 最大值 |
| ---- |	 ---- |	 ---- |	 ---- |
|开启位域(Bitfield)|	900|	2640|	3400|
|禁用位域(No Bitfield)	|900	|2640	|3400|

内存低于最小值，开垦将会失败中止。使用中间值，开垦速度会得到提升，但并非全速。所以，如果你想你进行并发开垦多个农田时，需要确保你有足够内存，设置内存超过了最大值并不会对开垦速度有所提升。对于最大值及最小值的范围目前是确定的，关于中间值的大小，社区还存在争议。后期确认后，将会更细图表，以便大家有更准确的参考信息。

## 精通开垦
大多数人使用GUI客户端来进行农田的开垦任务。你可以尝试并行开垦完成几块农田来进行测试了解。当你想要更稳定的方式开垦农田时，建议使用[命令行工具（CLI）](CLI-Commands-Reference)。需要注意的是，与MacOS及Linux系统相比，Windows下开垦速度会慢5%~10%。

在你慢慢了解掌握开垦农田的基本方法以后，如果你想掌握开垦更多并发开垦农田的技巧，可以观看官方在YouTube上发布的一个[农田开垦经验分享](https://www.youtube.com/watch?v=wDVsZMDlQYw)，其中分享了很多不同的方法。有使用二手服务器及SSD，有使用二手服务器及SAS硬盘作为缓存目录的，也有些人为自己的日用/游戏主机扩展了硬件设备，还有些人使用各种老旧计算机测试。他们编制了一份电子表格，包含了[不同硬件的开垦速度](Reference-Plotting-Hardware)。你可以通过查阅这些参考信息，来帮助你选取或者更换相应的硬件设备。

当你开始并发开垦农田时，请注意不要分配过多的内存给开垦任务，因为这可能会导致系统使用虚拟内存，开垦速度会下降乃至中断。对于线程数量的设置，根据处理器情况合理分配即可。

这里介绍一种常见的开垦耕种方案。你可以在你的游戏主机上完成农田的开垦，然后[移动农田](Moving-plots)并挂载到有很多USB接口的树莓派上。你可以在两个设备上都登陆账户（24位助记词）。或者在游戏主机上登陆账户运行节点（node）及农民（farm）进程，在树莓派上连接到游戏主机运行[远程收割](Farming-on-many-machines)进程进行耕种。

## 深入探索
建议开垦或者耕种农田的时候可以阅读一下WIKI的[FAQ答疑文档](FAQ)，其中的回答应该可以回答你90%的疑问。

在你阅读FAQ的过程中，你可以在官方讨论组相应的频道中获得社区的帮助与支持。

Keybase频道话题[_chia_network.public_ Keybase](https://keybase.io/team/chia_network.public):**

* \#公告（announcements）
* \#初学者（beginner）
* \#耕种设备（farming hardware）
* \#综合问题（general）
* \#中文区(lang_zh)
* \#农田开垦（plotting）
* \#杂谈（random） 
* \#测试网（support ）

## 感谢
@pyl, @kiwihaitch, @psydafke, @storage_jm [@roky](https://github.com/fangqiluxatu/Cn-Chia-Wiki)对本篇文档提供的帮助。后续如有更新及勘误，我将在这里进行做补充更正。

## 更新内容
自1.0.4版本起，内存所使用的最小、默认、最大值已更新。